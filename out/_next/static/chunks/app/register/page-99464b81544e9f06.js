(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{24654:function(){},26820:function(e,s,r){Promise.resolve().then(r.bind(r,86119))},86119:function(e,s,r){"use strict";r.d(s,{default:function(){return y}});var a=r(57437),t=r(59623);r(2265);var n=r(33627),o=r(91326),l=r(96537),i=r(70270),c=r(94696),d=r(62197),m=r(41665),u=r(88929),g=r(33013),p=r(80511),h=r(58433),f=r(98393);let x=e=>{let{loginLink:s,wrapperProps:r,contentProps:x,renderContent:y,formProps:j,hideForm:w}=e,{onSubmit:T,...Z}=j||{},{register:k,watch:P,handleSubmit:v,formState:{errors:I}}=(0,t.cI)({...Z}),C=(0,n.RU)(),{mutate:S,isLoading:b}=(0,n.mr)({v3LegacyAuthProviderCompatible:!!(null==C?void 0:C.isLegacy)}),N=(0,n.Nd)(),q=(0,n.nB)(),{Link:A}=(0,n.vR)(),E=(0,a.jsx)(i.Z,{...null!=x?x:{},children:(0,a.jsxs)(c.Z,{sx:{p:"32px","&:last-child":{pb:"32px"}},children:[!w&&(0,a.jsxs)(u.Z,{component:"form",onSubmit:v(e=>{if(T)return T(e);let{confirmPassword:s,...r}=e;return S({role:f.G.CUSTOMER,...r})}),spacing:2,children:[(0,a.jsxs)(h.ZP,{container:!0,children:[(0,a.jsx)(h.ZP,{xs:12,md:6,display:"flex",justifyContent:"center",children:(0,a.jsx)(g.Z,{...k("username",{required:"Username is required"}),id:"username",margin:"normal",fullWidth:!0,name:"username",label:"Username",helperText:I.username?I.username.message:"",error:!!I.username,type:"text",placeholder:"Username",autoComplete:"username",sx:{margin:"1rem"}})}),(0,a.jsx)(h.ZP,{xs:12,md:6,display:"flex",justifyContent:"center",children:(0,a.jsx)(g.Z,{...k("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),id:"email",margin:"normal",fullWidth:!0,label:"Email",error:!!I.email,helperText:I.email?I.email.message:"",name:"email",autoComplete:"email",type:"email",sx:{margin:"1rem"}})}),(0,a.jsx)(h.ZP,{xs:12,md:6,display:"flex",justifyContent:"center",children:(0,a.jsx)(g.Z,{...k("address",{required:"Address is required"}),id:"address",margin:"normal",fullWidth:!0,name:"address",label:"Address",helperText:I.address?I.address.message:"",error:!!I.address,type:"text",autoComplete:"street-address",sx:{margin:"1rem"}})}),(0,a.jsx)(h.ZP,{xs:12,md:6,display:"flex",justifyContent:"center",children:(0,a.jsx)(g.Z,{...k("phone",{required:"Phone is required"}),id:"phone",margin:"normal",fullWidth:!0,name:"phone",label:"Phone",helperText:I.phone?I.phone.message:"",error:!!I.phone,type:"text",autoComplete:"tel-local",sx:{margin:"1rem"}})}),(0,a.jsx)(h.ZP,{xs:12,md:6,display:"flex",justifyContent:"center",children:(0,a.jsx)(g.Z,{...k("name",{required:"Name is required"}),id:"name",margin:"normal",fullWidth:!0,name:"name",label:"Name",helperText:I.name?I.name.message:"",error:!!I.name,type:"text",autoComplete:"name",sx:{margin:"1rem"}})}),(0,a.jsx)(h.ZP,{xs:12,sx:{padding:"1rem"},children:(0,a.jsx)(p.Z,{children:"Password must contain at least 8 characters, 1 uppercase letter, 1 lowercase letter, and 1 number."})}),(0,a.jsx)(h.ZP,{xs:12,md:6,display:"flex",justifyContent:"center",children:(0,a.jsx)(g.Z,{...k("password",{required:!0,minLength:{value:8,message:"Password must be at least 8 characters"},validate:e=>/[A-Z]/.test(e)?/[a-z]/.test(e)?!!/[0-9]/.test(e)||"Password must contain at least 1 number":"Password must contain at least 1 lowercase letter":"Password must contain at least 1 uppercase letter"}),id:"password",margin:"normal",fullWidth:!0,name:"password",label:"Password",helperText:I.password?I.password.message:"",error:!!I.password,type:"password",autoComplete:"off",sx:{margin:"1rem"}})}),(0,a.jsx)(h.ZP,{xs:12,md:6,display:"flex",justifyContent:"center",children:(0,a.jsx)(g.Z,{...k("confirmPassword",{required:!0,validate:e=>P("password")===e||"Passwords do not match"}),id:"confirmPassword",margin:"normal",fullWidth:!0,name:"confirmPassword",label:"Confirm Password",helperText:I.confirmPassword?I.confirmPassword.message:"",error:!!I.confirmPassword,type:"password",autoComplete:"off",sx:{margin:"1rem"}})})]}),(0,a.jsx)(l.Z,{type:"submit",variant:"contained",disabled:b,sx:{mt:"24px",width:"100%",maxWidth:"400px",alignSelf:"center"},children:"Sign up"})]}),null!=s?s:(0,a.jsxs)(o.Z,{display:"flex",justifyContent:"flex-end",alignItems:"center",sx:{mt:"24px",display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,a.jsx)(p.Z,{variant:"body2",component:"span",fontSize:"12px",children:"Have an account?"}),(0,a.jsx)(m.Z,{ml:"4px",variant:"body2",color:"primary",component:"legacy"===N?A:q,underline:"none",to:"/dashboard/login",fontSize:"12px",fontWeight:"bold",children:"Sign in"})]})]})});return(0,a.jsx)(o.Z,{component:"div",...null!=r?r:{},children:(0,a.jsx)(d.Z,{component:"main",sx:{display:"flex",flexDirection:"column",justifyContent:w?"flex-start":"center",alignItems:"center",minHeight:"100dvh",padding:"16px",width:"100%"},children:(0,a.jsxs)(u.Z,{sx:{width:"100%",display:"flex",flexDirection:"column",paddingTop:w?"15dvh":0,gap:"2rem"},children:[(0,a.jsx)(p.Z,{variant:"h4",sx:{textAlign:"center",fontWeight:"bold"},children:"Create an account"}),y?y(E,null):(0,a.jsx)(a.Fragment,{children:E})]})})})};var y=()=>(0,a.jsx)("div",{children:(0,a.jsx)(x,{})})},98393:function(e,s,r){"use strict";r.d(s,{G:function(){return m},Z:function(){return u}});let a=r(42126).Z.create({baseURL:"/api"}),t=!1,n=[];a.interceptors.request.use(e=>{let s=localStorage.getItem("accessToken");return s&&(e.headers.Authorization="Bearer ".concat(s)),e}),a.interceptors.response.use(null,async e=>{if(401!==e.status)return Promise.reject(e);let s=localStorage.getItem("refreshToken");if(!s)return Promise.reject(e);if(t)return new Promise((s,r)=>n.push(()=>({resolve:s,reject:r,config:a(e.config)})));t=!0;let r=await l(s);return r.success?(localStorage.setItem("idToken",r.data.idToken),localStorage.setItem("accessToken",r.data.accessToken),localStorage.setItem("refreshToken",r.data.refreshToken),e.config.headers.Authorization="Bearer ".concat(r.data.accessToken),n.forEach(e=>{let{resolve:s,reject:t,config:n}=e;n.headers.Authorization="Bearer ".concat(r.data.accessToken),a.request(n).then(s).catch(t)}),n.length=0,t=!1,a(e.config)):(t=!1,Promise.reject(e))});let o=async e=>{let{username:s,password:r}=e;try{let e=await a.post("/auth/login/password",{username:s,password:r});return{success:!0,data:e.data}}catch(e){if(401===e.response.status)return{success:!1,message:"Invalid username or password"};return{success:!1,message:e.response.data.message}}},l=async e=>{try{let s=await a.post("/auth/token",{refreshToken:e});return{success:!0,data:s.data}}catch(e){return{success:!1,message:e.response.data.message}}},i=async e=>{try{return await a.put("/auth/token",{refreshToken:e}),{success:!0}}catch(e){return{success:!1,message:e.response.data.message}}},c=async e=>(await a.post("/auth/signup",e)).data;var d=r(49714);let m={ADMIN:"admin",TECHNICIAN:"technician",CUSTOMER:"customer"};var u={login:async e=>{let s=await o({username:e.username,password:e.password});if(!s.success)return{success:!1,error:{name:"Login Error",message:s.message}};let{userData:r}=(0,d.o)(s.data.idToken);return r.role.includes(e.role)||r.role.includes(m.ADMIN)?(localStorage.setItem("idToken",s.data.idToken),localStorage.setItem("accessToken",s.data.accessToken),localStorage.setItem("refreshToken",s.data.refreshToken),{success:!0,error:null,successNotification:{message:"Login successful. Welcome ".concat(r.username,"!")}}):{success:!1,error:{name:"Login Error",message:"You are not a ".concat(e.role)}}},check:async()=>{let e=localStorage.getItem("idToken"),s=localStorage.getItem("accessToken"),r=localStorage.getItem("refreshToken");return e&&s&&r?{authenticated:!0,error:null}:{authenticated:!1,error:{message:"Not logged in",name:"Not logged in"}}},logout:async()=>(await i(localStorage.getItem("refreshToken")),localStorage.removeItem("idToken"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),{success:!0,error:null,redirectTo:"/",successNotification:{message:"Logout successful"}}),onError:e=>{console.error(e)},register:async e=>{try{let s=await c(e);return console.log("userId",s),{success:!0,error:null,successNotification:{message:"Confirmation email sent",description:"Please confirm your email to login."}}}catch(e){return{success:!1,error:{name:"Register Error",message:e.message}}}},getIdentity:()=>{let e=localStorage.getItem("idToken");if(!e)return{id:null,fullName:null,email:null,emailVerified:null,phone:null,address:null,role:null};let{userData:s}=(0,d.o)(e);return{id:s._id,username:s.username,email:s.email,emailVerified:s.emailVerified,phone:s.phone,address:s.address,role:s.role}}}}},function(e){e.O(0,[999,303,511,7,292,205,339,971,23,744],function(){return e(e.s=26820)}),_N_E=e.O()}]);